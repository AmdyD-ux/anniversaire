<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Kiki 21 ‚Äî L'Exp√©rience Ultime ‚ù§Ô∏è</title>
<meta name="theme-color" content="#ff0a54">
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;800&family=Playfair+Display:ital,wght@1,600&display=swap" rel="stylesheet">
<style>
  :root {
    --primary: #ff0a54;
    --secondary: #ff477e;
    --glass: rgba(255, 255, 255, 0.05);
    --glass-border: rgba(255, 255, 255, 0.1);
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }
  
  body {
    background-color: #0f050a;
    background-image: radial-gradient(circle at 50% 50%, #2a0a18 0%, #000 100%);
    color: white;
    font-family: 'Outfit', sans-serif;
    overflow-x: hidden; min-height: 100vh;
    transition: background 1s;
  }

  /* --- COUCHE VIDEO ARRIERE-PLAN (NOUVEAU) --- */
  #bgVideoContainer {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    z-index: -3; /* Tout au fond */
    opacity: 0; /* Cach√© par d√©faut */
    transition: opacity 2s ease-in-out;
    pointer-events: none;
    overflow: hidden;
  }
  #bgVideoPlayer {
    width: 100%; height: 100%;
    object-fit: cover;
    filter: brightness(0.4) grayscale(30%) blur(3px); /* Effet Cin√©ma sombre */
    transform: scale(1.1); /* Pour √©viter les bords blancs du flou */
  }

  /* --- FILIGRANE (Watermark) --- */
  .watermark-bg {
    position: fixed; inset: 0; z-index: -1; /* Juste devant la vid√©o, derri√®re le texte */
    opacity: 0.05;
    pointer-events: none;
    background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' height='150px' width='250px'><text transform='translate(30, 100) rotate(-20)' fill='rgb(255,255,255)' font-size='18' font-family='sans-serif' font-weight='900'>By Mr D qui t'aime ‚ù§Ô∏è</text></svg>");
  }

  /* --- C≈íURS FLOTTANTS --- */
  .floating-heart-bg {
      position: fixed; color: var(--primary); opacity: 0;
      top: 100%; animation: floatUp 10s linear forwards;
      z-index: -2; font-size: 20px;
  }
  @keyframes floatUp { 
      0% { opacity: 0; transform: translateY(0) scale(0.5) rotate(0deg); } 
      20% { opacity: 0.5; }
      100% { opacity: 0; transform: translateY(-120vh) scale(1.5) rotate(360deg); } 
  }

  /* --- UI ELEMENTS --- */
  header {
    position: fixed; top: 0; width: 100%; z-index: 100;
    padding: 20px 0; backdrop-filter: blur(10px); background: rgba(0,0,0,0.4);
    border-bottom: 1px solid var(--glass-border);
  }
  .nav-container {
    width: min(1200px, 90%); margin: 0 auto;
    display: flex; justify-content: space-between; align-items: center;
  }
  .brand {
    font-family: 'Playfair Display', serif; font-style: italic; font-size: 22px;
    background: linear-gradient(45deg, #fff, var(--secondary)); -webkit-background-clip: text; color: transparent;
  }
  .tag { background: var(--primary); padding: 5px 15px; border-radius: 20px; font-size: 11px; font-weight: 800; text-transform: uppercase; }

  /* Hero */
  .hero { min-height: 90vh; display: flex; align-items: center; justify-content: center; padding-top: 80px; position: relative; }
  .hero-content { width: min(1200px, 90%); display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 40px; align-items: center; }
  @media(max-width: 900px) { .hero-content { grid-template-columns: 1fr; text-align: center; } }

  h1 {
    font-size: clamp(45px, 7vw, 75px); line-height: 1.1; font-weight: 800; margin-bottom: 20px;
    background: linear-gradient(135deg, #fff 40%, var(--secondary)); -webkit-background-clip: text; color: transparent;
    filter: drop-shadow(0 0 25px rgba(255,10,84,0.4));
  }

  .btn-show {
    padding: 15px 40px; border-radius: 50px; border: none;
    background: linear-gradient(90deg, var(--primary), #b14cff);
    color: white; font-size: 18px; font-weight: 700; cursor: pointer;
    box-shadow: 0 0 30px rgba(255, 10, 84, 0.5); transition: 0.3s; margin-bottom: 30px; animation: pulseBtn 2s infinite;
  }
  @keyframes pulseBtn { 0% { transform: scale(1); } 50% { transform: scale(1.05); box-shadow: 0 0 50px rgba(255, 10, 84, 0.8); } 100% { transform: scale(1); } }

  /* Countdown & Coeur */
  .countdown-box { background: var(--glass); border: 1px solid var(--glass-border); backdrop-filter: blur(10px); padding: 25px; border-radius: 20px; display: inline-block; }
  .countdown-grid { display: flex; gap: 20px; justify-content: center; }
  .time-val { font-size: 32px; font-weight: 800; color: var(--primary); text-shadow: 0 0 15px var(--primary); }
  .time-lbl { font-size: 10px; text-transform: uppercase; letter-spacing: 1px; opacity: 0.7; }

  .visual-side { position: relative; height: 400px; display: flex; justify-content: center; align-items: center; }
  .bokeh-container { position: relative; width: 300px; height: 300px; }
  .heart-shape { position: absolute; width: 100px; height: 100px; background: var(--primary); transform: rotate(-45deg); pointer-events: none; }
  .heart-shape::before, .heart-shape::after { content: ""; position: absolute; width: 100px; height: 100px; border-radius: 50%; background: inherit; }
  .heart-shape::before { top: -50px; left: 0; } .heart-shape::after { left: 50px; top: 0; }
  .h1 { top: 100px; left: 100px; background: radial-gradient(circle at 30% 30%, #ff5c8a, var(--primary)); box-shadow: 0 0 60px var(--primary); animation: beat 1.2s infinite; z-index: 10; }
  .h2 { top: 80px; left: 80px; width: 140px; height: 140px; background: var(--secondary); filter: blur(30px); opacity: 0.6; animation: float 6s infinite; z-index: 5; }
  .h2::before, .h2::after { width: 140px; height: 140px; } .h2::before { top: -70px; } .h2::after { left: 70px; }
  @keyframes beat { 0%,100%{transform:rotate(-45deg) scale(1)} 50%{transform:rotate(-45deg) scale(1.1)}}
  @keyframes float { 0%,100%{transform:rotate(-45deg) translateY(0)} 50%{transform:rotate(-45deg) translateY(-20px)}}
  .big-21 { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 220px; font-weight: 900; color: rgba(255,255,255,0.04); z-index: 1; user-select: none; }

  /* Gallery */
  .gallery-section { padding: 50px 0 150px; width: min(1200px, 92%); margin: 0 auto; }
  .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 15px; }
  .grid-item { aspect-ratio: 1; border-radius: 15px; overflow: hidden; border: 1px solid var(--glass-border); cursor: pointer; transition: 0.3s; position: relative; }
  .grid-item:hover { transform: scale(1.05); border-color: var(--primary); box-shadow: 0 10px 30px rgba(255,10,84,0.3); z-index: 2; }
  .grid-item img, .grid-item video { width: 100%; height: 100%; object-fit: cover; }
  .play-badge { position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); font-size: 30px; text-shadow: 0 0 10px black; }

  /* Modal Diaporama */
  .modal { position: fixed; inset: 0; z-index: 2000; display: none; background: #000; justify-content: center; align-items: center; }
  .modal.open { display: flex; }
  .modal-bg-blur { position: absolute; inset: -20px; background-size: cover; filter: blur(40px) brightness(0.4); opacity: 0.8; transition: 1s; }
  .modal-container { position: relative; z-index: 2; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; }
  .slide-item { max-width: 95%; max-height: 85vh; border-radius: 10px; box-shadow: 0 20px 50px rgba(0,0,0,0.8); animation: zoomIn 0.5s ease; }
  @keyframes zoomIn { from { opacity:0; transform:scale(0.9)} to { opacity:1; transform:scale(1)}}
  .close-modal { position: absolute; top: 30px; right: 30px; font-size: 40px; color: white; cursor: pointer; z-index: 10; background: none; border: none; }
  .progress-wrap { position: absolute; bottom: 0; left: 0; width: 100%; height: 5px; background: rgba(255,255,255,0.2); }
  .progress-bar { height: 100%; width: 0; background: var(--primary); }

  .music-btn { position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; border-radius: 50%; background: var(--primary); border: none; color: white; font-size: 24px; cursor: pointer; box-shadow: 0 0 30px var(--primary); z-index: 2100; transition: 0.3s; }
  .music-btn:hover { transform: scale(1.1); }
</style>
</head>
<body>

<div id="bgVideoContainer">
  <video id="bgVideoPlayer" muted playsinline></video>
</div>

<div class="watermark-bg"></div>

<audio id="bgMusic" loop><source src="musique.mp3" type="audio/mpeg"></audio>
<button class="music-btn" id="musicToggle">üéµ</button>

<header>
  <div class="nav-container">
    <div class="brand">Kiki 21 üëë</div>
    <div class="tag">By Mr D qui t'aime ‚ù§Ô∏è</div>
  </div>
</header>

<main>
  <section class="hero">
    <div class="hero-content">
      <div>
        <h1>Joyeux Anniversaire<br>Fatou Kin√© Diagne _ Mrs D</h1>
        <p style="font-size: 18px; color: rgba(255,255,255,0.8); margin-bottom: 25px;">
          Chaque seconde compte, chaque souvenir est pr√©cieux.
        </p>
        
        <button class="btn-show" id="startShow">‚ú® LANCER LE SHOW ‚ú®</button>

        <div class="countdown-box">
          <div id="countdownMsg" style="margin-bottom:10px; font-weight:600; color:var(--secondary)">En attendant la f√™te...</div>
          <div class="countdown-grid">
            <div><div class="time-val" id="d">00</div><div class="time-lbl">Jours</div></div>
            <div><div class="time-val" id="h">00</div><div class="time-lbl">Heures</div></div>
            <div><div class="time-val" id="m">00</div><div class="time-lbl">Min</div></div>
            <div><div class="time-val" id="s">00</div><div class="time-lbl">Sec</div></div>
          </div>
        </div>
      </div>

      <div class="visual-side">
        <div class="big-21">21</div>
        <div class="bokeh-container">
          <div class="heart-shape h2"></div>
          <div class="heart-shape h1"></div>
        </div>
      </div>
    </div>
  </section>

  <section class="gallery-section">
    <h2 style="margin-bottom: 20px; border-left: 4px solid var(--primary); padding-left: 15px;">Ta Galerie</h2>
    <div class="grid" id="grid"></div>
  </section>
</main>

<div class="modal" id="modal">
  <div class="modal-bg-blur" id="modalBg"></div>
  <button class="close-modal" id="closeModal">‚úï</button>
  <div class="modal-container" id="modalContent"></div>
  <div class="progress-wrap"><div class="progress-bar" id="pBar"></div></div>
</div>

<script>
/* 1. CONFIGURATION */
const FILES = [
  'Photo2.jpeg', 'Photo3.jpeg', 'Photo4.jpeg', 'Photo5.jpeg', 'Photo6.jpeg', 'Photo7.jpeg',
  'Video1.mp4', 'Video2.mp4', 'Video3.mp4', 'Video4.mp4', 'Video5.mp4', 'Video6.mp4', 'Video7.mp4', 'Video8.mp4'
];

/* 2. LOGIQUE BACKGROUND VID√âO AUTO ("De temps √† autre") */
const videoFiles = FILES.filter(f => f.toLowerCase().endsWith('.mp4'));
const bgContainer = document.getElementById('bgVideoContainer');
const bgPlayer = document.getElementById('bgVideoPlayer');

function playBackgroundMoment() {
  if(videoFiles.length === 0) return;
  // 1. Choisir une vid√©o au hasard
  const randomVid = videoFiles[Math.floor(Math.random() * videoFiles.length)];
  bgPlayer.src = 'media/' + randomVid;
  
  // 2. Tenter de lancer la vid√©o (muette obligatoirement)
  bgPlayer.play().then(() => {
    // 3. Fade In
    bgContainer.style.opacity = '1';
    
    // 4. √Ä la fin de la vid√©o, Fade Out
    bgPlayer.onended = () => {
      bgContainer.style.opacity = '0';
      // Relancer une autre dans un d√©lai al√©atoire (entre 10s et 20s)
      setTimeout(playBackgroundMoment, Math.random() * 10000 + 10000);
    };
  }).catch(e => {
    // Si autoplay bloqu√©, on r√©essaie plus tard
    setTimeout(playBackgroundMoment, 5000);
  });
}
// Lancer le cycle apr√®s 5 secondes
setTimeout(playBackgroundMoment, 5000);


/* 3. GALERIE & DIAPORAMA */
const mediaList = FILES.map(f => ({ src: 'media/' + f, type: f.endsWith('mp4') ? 'video' : 'image' }));
const grid = document.getElementById('grid');
const modal = document.getElementById('modal');
const modalContent = document.getElementById('modalContent');
const modalBg = document.getElementById('modalBg');
const pBar = document.getElementById('pBar');
let curIdx = 0;
let autoInt, pInt;

// Remplir la grille
mediaList.forEach((m, i) => {
  const d = document.createElement('div');
  d.className = 'grid-item';
  d.innerHTML = m.type === 'image' ? `<img src="${m.src}" loading="lazy">` : `<video src="${m.src}#t=0.1" muted></video><div class="play-badge">‚ñ∂</div>`;
  d.onclick = () => openShow(i);
  grid.appendChild(d);
});

function openShow(idx) {
  curIdx = idx;
  modal.classList.add('open');
  playMusic();
  renderSlide();
}

function renderSlide() {
  const m = mediaList[curIdx];
  modalContent.innerHTML = '';
  const el = document.createElement(m.type === 'image' ? 'img' : 'video');
  el.src = m.src;
  el.className = 'slide-item';
  
  if(m.type === 'image') {
    modalBg.style.backgroundImage = `url(${m.src})`;
    startTimer(5000); // 5 sec pour photo
  } else {
    el.controls = true; el.autoplay = true;
    el.onended = nextSlide; // Vid√©o suivante √† la fin
  }
  
  modalContent.appendChild(el);
  confetti({ particleCount: 30, spread: 60, origin: { y: 0.8 }, colors: ['#ff0a54', '#fff'] });
}

function nextSlide() {
  curIdx = (curIdx + 1) % mediaList.length;
  renderSlide();
}

function startTimer(ms) {
  clearInterval(autoInt); clearInterval(pInt);
  let start = Date.now();
  autoInt = setInterval(nextSlide, ms);
  pInt = setInterval(() => {
    let pct = Math.min(((Date.now()-start)/ms)*100, 100);
    pBar.style.width = pct + '%';
  }, 50);
}

document.getElementById('closeModal').onclick = () => {
  modal.classList.remove('open');
  clearInterval(autoInt); clearInterval(pInt);
  modalContent.innerHTML = '';
};
document.getElementById('startShow').onclick = () => openShow(0);

/* 4. MUSIQUE */
const audio = document.getElementById('bgMusic');
const mBtn = document.getElementById('musicToggle');
function playMusic(){ audio.play().then(()=>{ mBtn.innerHTML = '‚è∏'; }).catch(()=>{}); }
mBtn.onclick = () => {
  if(audio.paused) { playMusic(); } else { audio.pause(); mBtn.innerHTML = '‚ñ∂'; }
};
document.body.addEventListener('click', playMusic, {once:true});

/* 5. C≈íURS FLOTTANTS */
setInterval(() => {
  const h = document.createElement('div');
  h.className = 'floating-heart-bg';
  h.innerText = Math.random()>0.5 ? '‚ù§Ô∏è' : 'üíñ';
  h.style.left = Math.random()*100+'vw';
  h.style.animationDuration = (Math.random()*5+5)+'s';
  document.body.appendChild(h);
  setTimeout(()=>h.remove(), 10000);
}, 2000);

/* 6. COMPTE √Ä REBOURS & FEUX D'ARTIFICE */
const target = new Date(); target.setHours(24,0,0,0);
let boomed = false;
setInterval(() => {
  const diff = target - new Date();
  if(diff <= 0) {
    document.getElementById('countdownMsg').innerText = "üéâ JOYEUX ANNIVERSAIRE KIKI ! üéâ";
    if(!boomed) { 
      boomed = true; 
      playMusic();
      (function f() {
        confetti({ particleCount: 5, spread: 60, origin: { x: Math.random() }, colors: ['#ff0a54','#b14cff'] });
        if(Date.now() < Date.now()+10000) requestAnimationFrame(f);
      })();
    }
    return;
  }
  document.getElementById('d').innerText = Math.floor(diff/86400000).toString().padStart(2,'0');
  document.getElementById('h').innerText = Math.floor((diff/3600000)%24).toString().padStart(2,'0');
  document.getElementById('m').innerText = Math.floor((diff/60000)%60).toString().padStart(2,'0');
  document.getElementById('s').innerText = Math.floor((diff/1000)%60).toString().padStart(2,'0');
}, 1000);
</script>
</body>

</html>
